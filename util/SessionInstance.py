from enum import Enum


class SessionInstance:
    __instance = None
    connection_id = -1
    server_config_id = ""
    source_address_token = ""
    public_value = None # object
    public_values_bytes = ""
    private_value = None
    chlo = ""
    scfg = ""
    # cert = "308203B43082029CA003020102020101300D06092A864886F70D01010B0500301E311C301A06035504030C13515549432053657276657220526F6F74204341301E170D3138303631383132343835365A170D3139303631383132343835365A3064310B30090603550406130255533113301106035504080C0A43616C69666F726E69613116301406035504070C0D4D6F756E7461696E205669657731143012060355040A0C0B51554943205365727665723112301006035504030C093132372E302E302E3130820122300D06092A864886F70D01010105000382010F003082010A0282010100AC8B7A6986CB04B83BB6F6872B7635F9AA8DE89216A92B0C645FBCBFDF72F79E4B573198EB08331BA1E754E1B662B13A077E0A92D5FF1E8A8F79763F9C12DC4F58D4A35A61C0A8E49597DE614929276B41ECE9AF814A74B30BB9CF14143F4FC6B21A4511E5A6ACA4D174220E372FE043A105C0CBCE6E749D71265770628DDD2F8FD146AC5705DCEB3A73A1873BA9AFE0D5E1D348A123CA508B8ED816E896118AFF0C609545B61DACBBF0D656FCE68D8B7235907F30049148CAF5A39A2F4CB39F6DD79876A83E42262817963A95ED780C966F267136612980EE14FF5DD62CAA1140E6CFBB15264ACEF0F88FE6FE91182235FC8C73012695143219E6D1D48131DB0203010001A381B63081B3300C0603551D130101FF04023000301D0603551D0E041604143ECD5BB55DACCAD991FAECB9ABE7427BE5730CFB301F0603551D2304183016801441D602AE70B88354D750609956C2944C9DFFEAEB301D0603551D250416301406082B0601050507030106082B0601050507030230440603551D11043D303B820F7777772E6578616D706C652E6F726782106D61696C2E6578616D706C652E6F726782106D61696C2E6578616D706C652E636F6D87047F000001300D06092A864886F70D01010B050003820101000B7FDD3124F8D566FC352E04C88CEBF18FAD45EE4742A88D24703F35591326BF8695AFC276123F75AA4A5CCE6CAF442973CAED49E1BEC9516DCBE9D6E317E4BCD50C13C0B6EA6B20A0DFA3EC2BB129B35CC939912613CB5C74B22FF912F50F1D07B12027A6F5D74AC9D07579CB538E38C6613F0F5D023AA3C81D042002AF1F9BABC3FC2AFFC2D0567ACEF114A348C8249DC9BAA294F6088D83D8B33A92D1E6A9F611E167436732E63D89CF2D8476F0E80169D40F6329369C93EBF50B9E5E0B31D2175F366CA66BF6711713BACC118B3D1B786403E408884A3F3149C53B7CD62627CA3B3384AFC73F550F3133194B0D7D23F1CCEB971BF105865AEEBC15581DEA"
    cert = "30820309308201f1a00302010202143f5229d6c9afb21246280678d5431ab37c8eb714300d06092a864886f70d01010b050030143112301006035504030c096c6f63616c686f7374301e170d3233313032313034353235325a170d3233313132303034353235325a30143112301006035504030c096c6f63616c686f737430820122300d06092a864886f70d01010105000382010f003082010a0282010100aa7854bd082c3d00c108bad0c90c116e653701fa79279d5b8d04897cb279a4cf0d5c1ef9037016bf6ed11f944069d9c796ecd67c9fe518cbd20d2587b1bd9815b57c8bbf3a7294c26280c998adcc7fc08206c3cdebc8bb2194136d84c93711dcfd727d12388474f746e4d53932577f30865e22f0058bf591f619198c14c2b682a4444fa383183a51f5c9297adda3bdbb425ef321c4a0d9810836faa778fd6bac9582cba03bd7efedb1b93068d9a685fddfb024181d64eb136a2247c005224b459c7ae2b3dff9dcf97cfbb36904603416269756e35a81031117c3991dd1302fe7c1e50ef650e0441ee8239b6177e2e44d9d1e9311ce123bd8ca3d1e62b6b253730203010001a3533051301d0603551d0e0416041468e878da8e11ed16869be3c5cb6d4214974352d5301f0603551d2304183016801468e878da8e11ed16869be3c5cb6d4214974352d5300f0603551d130101ff040530030101ff300d06092a864886f70d01010b050003820101005248182e130b9079eedd92b412fec189a766d234a616983bedabf3d2ef63333a38e1c910f72cff01c591b7db5c2775556f1b332368494d4b3c670266abf6adc2a182d93a2e15f00eeb3c9cbb56af9f229c4e5dff40ed0bc009919d792b2652dfb13343736df32ecdc1f1ba371c17aa9ed580b18e49da016b7d219176826f4ed762b26d2b8789efad19a26799fa762193bf445b9df550ccb3646a8fba107002c0d7ed0e7fc856e40234da6936b1c35429b47375b93a30fbbcf04c489a5a4c59e10a9b70e424e0041cd3cf6ff4105fbf81f43e23cfa9eece12f42c9012c097d39f3cd930e7ba025c862aee2d434b4304344c2f621021d920fda7744acf51aaa010"
    # cert = "308203B130820299A003020102020101300D06092A864886F70D01010B0500301E311C301A06035504030C13515549432053657276657220526F6F74204341301E170D3138303631383131333635325A170D3139303631383131333635325A3064310B30090603550406130255533113301106035504080C0A43616C69666F726E69613116301406035504070C0D4D6F756E7461696E205669657731143012060355040A0C0B51554943205365727665723112301006035504030C093132372E302E302E3130820122300D06092A864886F70D01010105000382010F003082010A0282010100E721A45922B4A959F3031DAB012808C15F1A7AE79D2011603901312830B7E07C04EC6BA4B59EFD8AC02194AC55C5B307865B4E02ACECD196E65659AE78BE6871C830C65CF414DAE6B052570339AF3155009A17D86C970BBF394DAB904D682E4F5973CD330325D6CD1DCD7CE53E8A72882D8A962AABF295F7842ECAB96A107E67E24CB043D6B0A673B4809927FC39660DFABC38517A8A4CE7F4470BA45AD14EA4777E6747C1D86D63FA4BB9C9C560198DD281525EE385031D07ADBD3C5F73410D151032E2BD2D7E91A9C71C96765E6AF5120BE01F895E74917262E80A1F82BEBE8D04B1BCBACC17C1E659CD1567A4EB7D52EE460B6F9F00E015D278A7132B99E10203010001A381B33081B0300C0603551D130101FF04023000301D0603551D0E0416041451D9BEC55C258F2745B405EB53326DDA4C5AFE37301F0603551D230418301680144B163C9B75F4EDDD75939CB10864DFBBD7CB4EAE301D0603551D250416301406082B0601050507030106082B0601050507030230410603551D11043A3038820F7777772E6578616D706C652E6F7267820D7777772E65787472612E6F726782106D61696C2E6578616D706C652E636F6D87047F000001300D06092A864886F70D01010B050003820101009E1506021964176CA5A7C3AA012145F7123240A75DC9AF0AF09EBF6346411B282124ABC7486C9436C6840844EA5EFCB7E3BE87826ABBD30DFD4F79E08D0F3376EE195EC6DD3634CF03D551B213746EF5A708EB743EEB1AF0833D3694D5177E6481B91850362DEA98BB78153968C51450AEE76A8E309291881810285DC3087C17AF67A0259C15432A3D1B1065A1F4C8DAEE01C35918DECF77CC2CC8F3375FDAC7FEC1C3E892288347481204394B84C859C44095520E3ED80890E214A4E86956368E89496A90F6FDACB0F06FE48B35C16E41C8155AF7C46A14B3ACCB0FD98C561C9883BF36E7E001584BD25C5E9F730A8EE2159E69AE03E04938B4DC1DF0972BE0"
    server_nonce = "efc36b712c31d0adff9aa9f11cadc41ecc82eaa6a77edbb50539a6e614fb969da8b0d74d1a0a1026850e21412b116f9c21bcb7db"
    client_nonce = ""
    keys = {}
    peer_public_value = ""
    div_nonce = ""
    message_authentication_hash = ""
    associated_data = ""
    packet_number = ""
    largest_observed_packet_number = -1
    shlo_received = False
    nr_ack_send = 0
    connection_id_as_number = -1
    destination_ip = "127.0.0.1"  # Home connectiopns
    # destination_ip = "192.168.43.228"   # hotspot connections
    zero_rtt = False
    last_received_rej = ""  # We are only interested in the last REJ for the initial keys.
    last_received_shlo = ""
    app_keys = {'type': None, 'mah': "", 'key': {}}
    first_packet_of_new_command = False
    currently_sending_zero_rtt = False  # If it is set to True, then we do not need to store the REJ otherwise it will not work.

    @staticmethod
    def get_instance():
        if SessionInstance.__instance is None:
            return SessionInstance()
        else:
            return SessionInstance.__instance

    def __init__(self):
        if SessionInstance.__instance is not None:
            raise Exception("Singleton bla")
        else:
            self.server_config_id = "-1"
            self.source_address_token = "-1"
            SessionInstance.__instance = self


